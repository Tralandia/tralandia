{*
	$rentals array of Entity\Rental
*}

{block content}

<h1>{$pageH1}
	<span class="counter">
		({_o100002, $totalResultsCount ,null,[count=>$totalResultsCount]}{if $paginatorPage > 1}, {_o100202} {$paginatorPage}.{/if})
	</span>
</h1>

<div class="row-fluid">
	<div class="span12">
		<div class="mytabUi ui-tabs-nav ui-tabs">
			{if count($rentals)}
				<div id="tabs-1" class="ui-tabs-panel">
					{foreach $rentals as $rentalId}
						{var $foreachIterator = $iterator}
						{if $rentalId instanceof \Entity\Rental\Rental}
							{var $rental = $rentalId}
							{var $rentalId = $rentalId->getId()}
						{/if}

						{capture $rentalBrickCacheOptionsKey|trim}
							{$rentalBrickCacheOptions['key']|replace:'[rental]':'rental/'.$rentalId}
						{/capture}

						{cache $rentalBrickCacheOptionsKey,
							if => $rentalBrickCacheOptions['enabled'],
							expire => $rentalBrickCacheOptions['expiration'],
							tags => $rentalBrickCacheOptions['tags']}


						{var $rentalData = $findRental($rentalId); }
						{var $rentalService = $rentalData['service']; }
						{var $firstInterviewAnswerText = $rentalData['firstInterviewAnswerText']; }
						{var $rental = $rentalService->getEntity(); }
						{var $featured = $rentalService->isFeatured(); }

						{var $lastClass = ''}
						{if $foreachIterator->last}
							{var $lastClass = 'last'}
						{/if}
							<div class="row-fluid rentalList {$lastClass}" data-cache="{$rand}">
								<div class="span4">
									<a href="{link Rental:detail $rental}" n:class="$featured ? top : classic">
										{* <div class="price">{$rental->price} <span>EUR</span></div> *}
										<div class="position">TOP</div>

										{if $mainImage = $rental->getMainImage()}
											<img n:image="$mainImage"/>
										{/if}

									</a>
								</div>
								<div class="span8">
									<h2>
										<a href="{link Rental:detail $rental}" title="{_$rental->name}">{_$rental->name}</a>{if $rental->classification > 0 }&nbsp;<span class="classification">{for $i = 0; $i < $rental->classification; $i++}
										<i class="entypo-star"></i>{/for}{/if}</span></h2>

										{* {if $mainImage = $rental->getMainImage()} *}
										{if 1}
											<button rel="{$rental->id}" data-name="{_$rental->name}{if $rental->classification > 0 } {for $i = 0; $i < $rental->classification; $i++}~star~{/for}{/if}" data-thumb="{image $rental->getMainImage()}" data-location="{_$rental->address->locality->name}" data-price="{$rental->price}" data-capacity="{$rental->maxCapacity} {_o490,null,[count=>$rental->maxCapacity]}" data-link="{link Rental:detail $rental}" class="addToFavorites btn btn-mini listCompareBtn active"><i class="icon-heart"></i> {_o100140} </button>
										{/if}

									<div class="clearfix"></div>

									<p class="locations">
										{*<a href="{link Rental:list location => $rental->address->locality , rentalType => $rental->type}">{_$rental->type->name|firstUpper} {_$rental->address->locality->name}</a>*}
										{_$rental->type->name|firstUpper}
										{if $rental->hasPlacement()}{_$rental->getPlacement()->name}, {/if}
										{_$rental->address->locality->name}

										{*
										{if count($rental->address->getLocations()) > 0}
										(
										{foreach $rental->address->getLocations() as $location}
											<a href="{link Rental:list location => $location}">{_$location->name}</a>{if !$iterator->last}, {/if}
										{/foreach}
										)
										{/if}
										*}

									</p>

									<p class="red teaser">{_$rental->teaser|firstUpper}</p>

									<p class="answer">
										{if $firstInterviewAnswerText}
											{$firstInterviewAnswerText}
										{/if}
									</p>


									<div class="panel baseBorder">
										<table class="holder">
											<tbody>
											<tr>
												<td width="90%">
													<b>{_o100041} {$rental->price}</b> {_o100004},
													<b>{_o924}</b> {$rental->maxCapacity} {_o490,null,[count=>$rental->maxCapacity]} {if $rental->bedroomCount > 0}({$rental->bedroomCount} {_o100009,null,[count=>$rental->bedroomCount]}){/if}

												</td>

												{*
												{if $rental->rank}<span class="entypo-discusion"></span><a href="#">{$rental->rank} hodnoteni</a>{/if}
												*}

											</tr>
											</tbody>
										</table>
										<p class="accessories">
											{var $importantAmenities = $rental->getImportantAmenities(true)}
											{foreach $importantAmenities  as $amenity}
												{if $iterator->first}{_$amenity->name|firstUpper}{else}{_$amenity->name}{/if}{if !$iterator->last}, {/if}
											{/foreach}
										</p>
									</div>

								</div>
							</div>
						{/cache}
					{/foreach}
					{control p}

				</div>
			{else}
				<div class="noSearchResults">
					<i class="entypo-search"></i>
					<h2>Nenašiel som žiadne ubytovacie zariadenia.</h2>
					<p>Skúste iné vyhľadávanie, jemnejšie kritériá.</p>
				</div>
			{/if}
		</div>
	</div>

</div>


